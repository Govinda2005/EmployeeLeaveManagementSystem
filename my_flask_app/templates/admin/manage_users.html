{% extends "layout/base.html" %} {% block title %}Manage Users{% endblock %} {%
block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="fas fa-users-cog me-2"></i>Manage Users</h1>
  <a href="{{ url_for('admin.add_user') }}" class="btn btn-primary">
    <i class="fas fa-user-plus me-1"></i> Add New User
  </a>
</div>
<div class="card">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Manager</th>
            <th>Active</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users.items %}
          <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.full_name }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.role.value.title() }}</td>
            <td>
              {% if user.manager %} {{ user.manager.full_name }} {% else %} — {%
              endif %}
            </td>
            <td>
              {% if user.is_active %}
              <span class="badge bg-success">Yes</span>
              {% else %}
              <span class="badge bg-secondary">No</span>
              {% endif %}
            </td>
            <td>
              <a
                href="{{ url_for('admin.edit_user', user_id=user.id) }}"
                class="btn btn-sm btn-outline-primary"
                title="Edit"
              >
                <i class="fas fa-edit"></i>
              </a>
              <a
                href="{{ url_for('admin.delete_user', user_id=user.id) }}"
                class="btn btn-sm btn-outline-danger"
                onclick="return confirm('Delete user {{ user.full_name }}?');"
                title="Delete"
              >
                <i class="fas fa-trash-alt"></i>
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <!-- Pagination -->
    <nav aria-label="User pagination">
      <ul class="pagination justify-content-center">
        {% if users.has_prev %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('admin.manage_users', page=users.prev_num) }}"
            >Previous</a
          >
        </li>
        {% else %}
        <li class="page-item disabled">
          <span class="page-link">Previous</span>
        </li>
        {% endif %} {% for page_num in users.iter_pages(left_edge=2,
        right_edge=2) %} {% if page_num %}
        <li class="page-item {% if page_num == users.page %}active{% endif %}">
          <a
            class="page-link"
            href="{{ url_for('admin.manage_users', page=page_num) }}"
            >{{ page_num }}</a
          >
        </li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">…</span></li>
        {% endif %} {% endfor %} {% if users.has_next %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('admin.manage_users', page=users.next_num) }}"
            >Next</a
          >
        </li>
        {% else %}
        <li class="page-item disabled"><span class="page-link">Next</span></li>
        {% endif %}
      </ul>
    </nav>
  </div>
</div>
{% endblock %}
